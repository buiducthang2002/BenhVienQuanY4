@model APP.Models.ThanhToan

@{
    ViewData["Title"] = "S·ª≠a Ch·ªâ ƒê·ªãnh";
}

<style>
    .edit-form-custom {
        max-width: 800px;
        margin: 0 auto;
    }

    .form-label-custom {
        font-weight: 600;
        color: #333;
        margin-bottom: 8px;
    }

    .form-control-custom {
        border: 2px solid #f8bbd0;
        border-radius: 6px;
        padding: 10px 15px;
        transition: all 0.3s ease;
    }

    .form-control-custom:focus {
        border-color: #e91e63;
        box-shadow: 0 0 0 0.2rem rgba(233, 30, 99, 0.15);
    }

    .btn-save-custom {
        background: linear-gradient(135deg, #4caf50 0%, #43a047 100%);
        border: none;
        color: white;
        font-weight: 600;
        padding: 12px 30px;
        border-radius: 6px;
        transition: all 0.3s ease;
        box-shadow: 0 3px 6px rgba(76, 175, 80, 0.3);
    }

    .btn-save-custom:hover {
        background: linear-gradient(135deg, #43a047 0%, #388e3c 100%);
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(76, 175, 80, 0.4);
        color: white;
    }

    .btn-cancel-custom {
        background: linear-gradient(135deg, #9e9e9e 0%, #757575 100%);
        border: none;
        color: white;
        font-weight: 600;
        padding: 12px 30px;
        border-radius: 6px;
        transition: all 0.3s ease;
        box-shadow: 0 3px 6px rgba(158, 158, 158, 0.3);
    }

    .btn-cancel-custom:hover {
        background: linear-gradient(135deg, #757575 0%, #616161 100%);
        transform: translateY(-2px);
        box-shadow: 0 5px 10px rgba(158, 158, 158, 0.4);
        color: white;
    }

    .info-display {
        background-color: #f5f5f5;
        padding: 10px 15px;
        border-radius: 6px;
        border-left: 4px solid #e91e63;
    }
</style>

<div class="container-fluid edit-form-custom">
    <div class="text-center mb-4">
        <h2 class="text-primary">
            ‚úèÔ∏è S·ª¨A TH√îNG TIN CH·ªà ƒê·ªäNH
        </h2>
        <hr />
    </div>

    @if (TempData["ErrorMessage"] != null)
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>L·ªói!</strong> @TempData["ErrorMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-info text-white">
            <h5 class="mb-0">üìã Th√¥ng tin kh√¥ng th·ªÉ s·ª≠a</h5>
        </div>
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <strong>M√£ thanh to√°n:</strong>
                    <div class="info-display">@Model.mathanhtoan</div>
                </div>
                <div class="col-md-4">
                    <strong>M√£ KCB:</strong>
                    <div class="info-display">@Model.makcb</div>
                </div>
                <div class="col-md-4">
                    <strong>S·ªë phi·∫øu:</strong>
                    <div class="info-display">@Model.sophieu</div>
                </div>
            </div>
        </div>
    </div>

    <form asp-action="Edit" method="post">
        @Html.AntiForgeryToken()
        @Html.HiddenFor(m => m.mathanhtoan)
        @Html.HiddenFor(m => m.makcb)
        @Html.HiddenFor(m => m.sophieu)
        @Html.HiddenFor(m => m.songaydungdon)
        @Html.HiddenFor(m => m.daky)

        <div class="card shadow-sm">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0">‚úèÔ∏è Th√¥ng tin c√≥ th·ªÉ s·ª≠a</h5>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <!-- Ng√†y -->
                    <div class="col-md-6">
                        <label class="form-label form-label-custom">
                            üìÖ Ng√†y <span class="text-danger">*</span>
                        </label>
                        <input type="datetime-local"
                               asp-for="ngay"
                               class="form-control form-control-custom"
                               required />
                        <span asp-validation-for="ngay" class="text-danger"></span>
                    </div>

                    <!-- M√£ NV -->
                    <div class="col-md-6">
                        <label class="form-label form-label-custom">
                            üë§ M√£ nh√¢n vi√™n
                        </label>
                        <input type="number"
                               asp-for="manv"
                               class="form-control form-control-custom"
                               placeholder="Nh·∫≠p m√£ nh√¢n vi√™n" />
                        <span asp-validation-for="manv" class="text-danger"></span>
                    </div>

                    <!-- Ai l√†m -->
                    <div class="col-md-12">
                        <label class="form-label form-label-custom">
                            üîß Ai l√†m
                        </label>
                        <textarea asp-for="ailam"
                                  class="form-control form-control-custom"
                                  rows="3"
                                  placeholder="Nh·∫≠p th√¥ng tin ng∆∞·ªùi l√†m"
                                  maxlength="500"></textarea>
                        <span asp-validation-for="ailam" class="text-danger"></span>
                        <small class="text-muted">T·ªëi ƒëa 500 k√Ω t·ª±</small>
                    </div>

                    <!-- M√£ ai l√†m -->
                    <div class="col-md-6">
                        <label class="form-label form-label-custom">
                            üÜî M√£ ai l√†m
                        </label>
                        <input type="number"
                               asp-for="maailam"
                               class="form-control form-control-custom"
                               placeholder="Nh·∫≠p m√£ ai l√†m" />
                        <span asp-validation-for="maailam" class="text-danger"></span>
                    </div>

                    <!-- Ng√†y th·ª±c hi·ªán -->
                    <div class="col-md-6">
                        <label class="form-label form-label-custom">
                            üìÜ Ng√†y th·ª±c hi·ªán
                        </label>
                        <input type="datetime-local"
                               asp-for="ngaythyl"
                               class="form-control form-control-custom" />
                        <span asp-validation-for="ngaythyl" class="text-danger"></span>
                    </div>
                </div>
            </div>
            <div class="card-footer text-center">
                <button type="submit" class="btn btn-save-custom me-2">
                    üíæ L∆∞u thay ƒë·ªïi
                </button>
                <a asp-action="Index" class="btn btn-cancel-custom">
                    ‚ùå H·ªßy
                </a>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        // Chuy·ªÉn ƒë·ªïi DateTime t·ª´ C# sang ƒë·ªãnh d·∫°ng datetime-local
        document.addEventListener('DOMContentLoaded', function() {
            const ngayInput = document.querySelector('input[name="ngay"]');
            const ngaythylInput = document.querySelector('input[name="ngaythyl"]');

            // Format ng√†y hi·ªán t·∫°i
            if (ngayInput && ngayInput.value) {
                const date = new Date(ngayInput.value);
                ngayInput.value = date.toISOString().slice(0, 16);
            }

            // Format ng√†y th·ª±c hi·ªán
            if (ngaythylInput && ngaythylInput.value && ngaythylInput.value !== '0001-01-01T00:00:00') {
                const date = new Date(ngaythylInput.value);
                ngaythylInput.value = date.toISOString().slice(0, 16);
            }
        });
    </script>
}
